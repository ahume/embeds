<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Embed ideas</title>
        <meta name="viewport" content="width=device-width">
        <style>
            body {
                color: red;
            }
            iframe {
                border: none;
                margin: 0;
                padding: 0;
                outline: red;
            }
        </style>

        <script src="http://pasteup.guim.co.uk/js/lib/requirejs/2.1.5/require.min.js"></script>
        <script>

            window.addEventListener('DOMContentLoaded', function() {

                require(['scripts/embed'], function(embed) {
                    embed.enhance();

                    //Then we get a dynamic update
                    var htmlFromApi = '<iframe class="api-embed" srcdoc="<script>document.write(\'async embed\');<' + '/script>"></iframe>';

                    // Bung it in the document and run the enhance again
                    document.querySelector('.async-embed').innerHTML = htmlFromApi;
                    embed.enhance();

                });

            }, false);

        </script>

        <div class="async-embed"></div>

        <div class="sync-embed">
            <p>Some content</p>

            <iframe class="api-embed" srcdoc='<div id="DC-note-60903" class="DC-note-container"></div><script src="http://s3.documentcloud.org/notes/loader.js"></script><script>dc.embed.loadNote("http://www.documentcloud.org/documents/371660/annotations/60903.js");</script>'></iframe>

            <p>Some content</p>

            <iframe class="api-embed" srcdoc="<script>document.write('normal sync embed');</script>"></iframe>

            <p>Some content</p>
        </div>


    </body>
</html>
